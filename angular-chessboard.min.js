!function(){"use strict";angular.module("nywton.chessboard",[]).value("nywtonChessboardDefaultConfig",{position:void 0,showNotation:!0,orientation:"white",draggable:!1,dropOffBoard:"snapback",appearSpeed:200,moveSpeed:200,snapbackSpeed:50,snapSpeed:25,trashSpeed:100,sparePieces:!1,showErrors:!1,pieceTheme:void 0,onDragStart:angular.noop,onDrop:angular.noop,onSnapEnd:angular.noop,onChange:angular.noop,onDragMove:angular.noop,onSnapbackEnd:angular.noop,onMoveEnd:angular.noop,onMouseoutSquare:angular.noop,onMouseoverSquare:angular.noop}).provider("nywtonChessboardConfig",[function(){var a={};this.pieceTheme=function(b){return a.pieceTheme=b,this},this.position=function(b){return a.position=b,this},this.draggable=function(b){return a.draggable=b,this},this.sparePieces=function(b){return a.sparePieces=b,this},this.$get=["nywtonChessboardDefaultConfig",function(b){return angular.extend(b,a)}]}]).config(["nywtonChessboardConfigProvider",function(a){a.position("empty")}]).directive("nywtonChessboard",["$window","$log","$timeout","nywtonChessboardConfig",function(a,b,c,d){var e=["draggable","dropOffBoard","position","orientation","showNotation","sparePieces","showErrors","pieceTheme","appearSpeed","moveSpeed","snapbackSpeed","snapSpeed","trashSpeed"],f=["onChange","onDragStart","onDragMove","onDrop","onSnapbackEnd","onMoveEnd","onMouseoutSquare","onMouseoverSquare","onSnapEnd"],g={restrict:"EA",scope:{name:"@",board:"=",onChange:"&",onDragMove:"&",onDrop:"&",onSnapbackEnd:"&",onMoveEnd:"&",onMouseoutSquare:"&",onMouseoverSquare:"&",onSnapEnd:"&",onDragStart:"&onDragStartCb"},priority:1e3,template:"<div></div>",controller:["$scope",function(a){var c=this,e=[];a.name=a.name||"board"+a.$id,this.config_push=function(a){angular.isArray(a)&&2===a.length&&angular.isString(a[0])&&!angular.isUndefined(a[1])&&e.push(a)},this.config=function(){var a={};angular.forEach(e,function(b){a[b[0]]=b[1]});var c=angular.extend(angular.copy(d),a);return b.debug(c),c},this.board=function(){return a.board};var g=function(){return a.$$phase||a.$root.$$phase?0:a.$parent.$digest()},h=function(a,b){return a.$$phase||a.$root.$$phase?b():a.$apply(b)},i=!0,j=function(b){return function(){var c=arguments;return h(a.$parent,function(){return b.apply(this,c)})}};angular.forEach(f,function(b){if(angular.isFunction(a[b])){var d=a[b]();if(angular.isFunction(d)){var e=i?j(d):d;c.config_push([b,e])}else c.config_push([b,g])}})}],link:function(c,d,f,g){angular.forEach(e,function(a){b.debug("attr: "+a+" = "+c.$eval(f[a])),f.hasOwnProperty(a)&&g.config_push([a,c.$eval(f[a])])});var h=g.config(),i=angular.element("<div></div>");d.prepend(i),c.board=new a.ChessBoard(i,h),c.board.name=c.name||"board"+c.$id,c.$on("$destroy",function(){c.board.destroy()})}};return g}]).directive("nywtonPositionRuyLopez",[function(){var a={restrict:"A",priority:1,require:"nywtonChessboard",link:function(a,b,c,d){d.config_push(["position","r1bqkbnr/pppp1ppp/2n5/1B2p3/4P3/5N2/PPPP1PPP/RNBQK2R"])}};return a}]).directive("nywtonPositionStart",[function(){var a={restrict:"A",priority:1,require:"nywtonChessboard",link:function(a,b,c,d){d.config_push(["position","start"])}};return a}]).directive("nywtonChessboardAutoresize",["$window","$timeout",function(a,b){var c={restrict:"A",priority:1,require:"nywtonChessboard",link:function(c,d,e,f){var g,h=function(){angular.isDefined(f.board())&&f.board().resize()};angular.element(a).bind("resize",function(){b.cancel(g),g=b(h,113)}),c.$on("$destroy",function(){b.cancel(g)})}};return c}])}();